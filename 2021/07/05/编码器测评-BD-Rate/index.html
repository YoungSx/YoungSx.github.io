


<!DOCTYPE html>
<html lang="zh-cn">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
  <title>编码器测评 - BD-Rate [ 不懂鸟语的人 ]</title>
  
    <!-- stylesheets list from _config.yml -->
    
      <link rel="stylesheet" href="/css/acanal.css">
    
      <link rel="stylesheet" href="/css/highlight.css">
    
  
</head>
<body>

<div id="menu-outer">
  <div id="menu-inner">
    
      <a href="/">Home</a>
    
      <a href="/about">About</a>
    
      <a href="/links">Links</a>
    
      <a href="/archives">Archives</a>
    
  </div>
</div>

<div id="content-outer">
  <div id="content-inner">
    
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
          tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            processEscapes: true
          }
        });
      </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
            tex2jax: {
              skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
            }
          });
      </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
              var all = MathJax.Hub.getAllJax(), i;
              for(i=0; i < all.length; i += 1) {
                  all[i].SourceElement().parentNode.className += ' has-jax';
              }
          });
      </script>

    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>



<article id="post">
  <header class="page-header">
  <div id="site-info">
    <div class="post-date-left">
      
        Mon Jul 05 2021 16:25:04 GMT+0800
      
    </div>
    <div class="site-title-area">
      <div class="site-title">不懂鸟语的人</div>
      <div class="site-subtitle">我的个人学习笔记</div>
    </div>
    <div class="post-date-right">
      
        Mon Jul 05 2021 16:25:04 GMT+0800
      
    </div>
  </div>
</header>
  
  <h1>编码器测评 - BD-Rate</h1>
  <div class="post-body">
    <h1 id="BD-Rate"><a href="#BD-Rate" class="headerlink" title="BD-Rate"></a>BD-Rate</h1><h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>全称 Bjøntegaard-Delta rate，用于评价不同的视频编码器RD（率-Rate，失真-Distortion）性能<br>是 Gisle Bjøntegaard 等人在 H.264 标准开发过程中提出的</p>
<h2 id="分类"><a href="#分类" class="headerlink" title="分类"></a>分类</h2><p>通常分为：</p>
<ol>
<li>BD-PSNR<br> 反映相同码率下平均 PSNR(dB) 差值</li>
<li>BD-BR（BD-BitRate）<br> 反映相同 PSNR 下平均的码率变化比例（%）</li>
</ol>
<h2 id="测试点的选取"><a href="#测试点的选取" class="headerlink" title="测试点的选取"></a>测试点的选取</h2><p>由于测试的工作量比较大，通常只选用4个典型的 <strong>QP</strong> 值，H.26X 中常采用的是：</p>
<ul>
<li>22</li>
<li>27</li>
<li>32</li>
<li>37</li>
</ul>
<p>其他编码算法由于量化方法的不同会选择不同的 QP 值，但为了方便比较通常要求器码率画着 PSNR 变化范围相近。</p>
<h2 id="多项式插值（函数图像拟合）"><a href="#多项式插值（函数图像拟合）" class="headerlink" title="多项式插值（函数图像拟合）"></a>多项式插值（函数图像拟合）</h2><p>Lagrange 插值容易严重过拟合，目前的版本中通常采用形状保持的分段三次 Hermite 插值法（<strong>SPPCHIP</strong>）。</p>
<h3 id="Linear"><a href="#Linear" class="headerlink" title="Linear"></a>Linear</h3><ul>
<li>完美区间单调性</li>
<li>不平滑</li>
</ul>
<h3 id="Lagrange"><a href="#Lagrange" class="headerlink" title="Lagrange"></a>Lagrange</h3><ul>
<li>非常平滑</li>
<li>严重过拟合<script type="math/tex; mode=display">
P(x) = \sum_{i=0}^{n-1}a_ix^i=a_0+a_1x+... a_{n-1}x^{n-1}</script></li>
</ul>
<h3 id="CHIP"><a href="#CHIP" class="headerlink" title="CHIP"></a>CHIP</h3><p>三次 Hermite 插值多项式 （Cubic Hermite Interpolation Polynomial, <strong>CHIP</strong>），一阶导数存在</p>
<p>设已知两点$(x_0, x_1)$和$(x_1, y_1)$，$x_0&lt;x_1$，假设其一阶导数存在$d_0, d_1$</p>
<script type="math/tex; mode=display">
P(x) = a_0+a_1x+a_2x^2+a_3x^3, x\epsilon[x_0, x_1].</script><p>则</p>
<script type="math/tex; mode=display">
P(x_0) = a_0+a_1x_0+a_2{x_0}^2+a_3{x_0}^3=y_0</script><script type="math/tex; mode=display">
P(x_1) = a_0+a_1x_1+a_2{x_1}^2+a_3{x_1}^3=y_1</script><script type="math/tex; mode=display">
P'(x_0) = a_1+2a_2x_0+3a_3{x_0}^2=d_0</script><script type="math/tex; mode=display">
P'(x_1) = a_1+2a_2x_1+3a_3{x_1}^2=d_1</script><p>令</p>
<script type="math/tex; mode=display">
h=x_1-x_0, \\
s=x-x_0,\\
\delta=\frac{y_1-y_0}{x_1-x_0}</script><p>可得</p>
<script type="math/tex; mode=display">
\begin{align}
P(x) &= H_1(x)y_0+H_2(x)y_1+H_3(x)d_0+H_4(x)d_1 \\
&=\frac{h^3-3hs^2+2s^3}{h^3}y_0+\frac{3hs^2-2s^3}{h^3}y_1+\frac{s(s-h)^2}{h^2}d_0+\frac{s^2(s-h)}{h^2}d_1 \\
&=y_0+sd_0+s^2\frac{3\delta-2d_0-d_1}{h}+s^3\frac{d_0-2\delta+d_1}{h^2} \\
&=y_0+sd_0+s^2c_0+s^3b_0
\end{align}</script><h3 id="PCHIP"><a href="#PCHIP" class="headerlink" title="PCHIP"></a>PCHIP</h3><p>分段三次 Hermite 插值多项式 （Piecewise Cubic Hermite Interpolation Polynomial, <strong>PCHIP</strong>）</p>
<h3 id="SPPCHIP"><a href="#SPPCHIP" class="headerlink" title="SPPCHIP"></a>SPPCHIP</h3><p>形状保持的分段三次 Hermite 插值多项式（Shape-Preserving Piecewise Cubic Hermite Interpolation Polynomial, <strong>SPPCHIP</strong>），是在保持<strong>区间单调性</strong>的同时，使得样点处的一阶导数连续，从而使得插值后的曲线更加平滑。</p>
<h3 id="Spline"><a href="#Spline" class="headerlink" title="Spline"></a>Spline</h3><p>分段三次样条插值</p>
<ul>
<li>比 SPPCHIP 更加平滑，又不会像 Lagrange 严重过拟合</li>
<li>但是区间不一定单调</li>
</ul>
<h2 id="Calc-Steps"><a href="#Calc-Steps" class="headerlink" title="Calc Steps"></a>Calc Steps</h2><h3 id="BD-PSNR"><a href="#BD-PSNR" class="headerlink" title="BD-PSNR"></a>BD-PSNR</h3><ol>
<li>取积分区间: (minBitRate, maxBitRate)<ol>
<li>minBitRate: max(min(anchor), min(testCase))</li>
<li>maxBitRate: min(max(anchor), max(testCase))</li>
</ol>
</li>
<li><strong>码率</strong>以 10 为底取对数（取对数后，码率之间的倍数关系会变成相减）</li>
<li><em>三次</em>函数曲线拟合（拟合方法见“函数曲线拟合”小节）</li>
<li>将「3’」的函数在「1’」区间上<strong>积分</strong></li>
<li>积分差值除以积分区间，以取平均</li>
<li>对数反变换（将「5’」的平均值作为 10 的幂），得到testCase（被测编码器）相对于基准编码器（anchor）的倍数</li>
<li>「6’」减 1 得到变化率</li>
</ol>
<h3 id="BD-BR-BD-BitRate"><a href="#BD-BR-BD-BitRate" class="headerlink" title="BD-BR (BD-BitRate)"></a>BD-BR (BD-BitRate)</h3><ol>
<li>取积分区间: (minPSNR, maxPSNR)<ol>
<li>minBitRate: max(min(anchor), min(testCase))</li>
<li>maxBitRate: min(max(anchor), max(testCase))</li>
</ol>
</li>
<li><strong>码率</strong>以 10 为底取对数（取对数后，码率之间的倍数关系会变成相减）</li>
<li><em>三次</em>函数曲线拟合（拟合方法见“函数曲线拟合”小节）</li>
<li>将「3’」的函数在「1’」区间上<strong>积分</strong></li>
<li>积分差值除以积分区间，以取平均</li>
<li>对数反变换（将「5’」的平均值作为 10 的幂），得到testCase（被测编码器）相对于基准编码器（anchor）的倍数</li>
<li>「6’」减 1 得到变化率</li>
</ol>
<h1 id="Expand"><a href="#Expand" class="headerlink" title="Expand"></a>Expand</h1><h2 id="ROC-Receiver-Operating-Characteristic"><a href="#ROC-Receiver-Operating-Characteristic" class="headerlink" title="ROC (Receiver Operating Characteristic)"></a>ROC (Receiver Operating Characteristic)</h2><p>用来比较不同分类器的相关性能</p>
<p>横坐标 FPR (costs)，纵坐标 TPR (benefits)</p>
<p>ROC Curve 越接近左上角，分类器性能越好，意味着分类器在假阳率很低的同时获得了很高的真阳率</p>
<h2 id="AUC-Area-Under-the-Curve-of-ROC"><a href="#AUC-Area-Under-the-Curve-of-ROC" class="headerlink" title="AUC (Area Under the Curve of ROC)"></a>AUC (Area Under the Curve of ROC)</h2><ul>
<li><p>ROC 曲线下的面积</p>
</li>
<li><p>BD-Rate 相当于 AUC</p>
</li>
</ul>
<h3 id="物理意义"><a href="#物理意义" class="headerlink" title="物理意义"></a>物理意义</h3><p>任取一对（正、负）样本，正样本的 score 大于负样本的 score 的概率。</p>
<h1 id="References"><a href="#References" class="headerlink" title="References"></a>References</h1><ul>
<li>BD-rate <a href="https://xjsxjtu.github.io/2017-04-17/RD-rate/#%E7%AE%97%E6%B3%95" target="_blank" rel="noopener">https://xjsxjtu.github.io/2017-04-17/RD-rate/#%E7%AE%97%E6%B3%95</a></li>
<li>【机器学习笔记】：一文让你彻底理解准确率，精准率，召回率，真正率，假正率，ROC/AUC <a href="https://zhuanlan.zhihu.com/p/46714763" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/46714763</a></li>
<li>机器学习算法常用指标总结 <a href="https://tianchi.aliyun.com/forum/postDetail?postId=79707" target="_blank" rel="noopener">https://tianchi.aliyun.com/forum/postDetail?postId=79707</a></li>
<li>BD-rate计算原理 <a href="https://blog.csdn.net/weixin_42348033/article/details/104892903" target="_blank" rel="noopener">https://blog.csdn.net/weixin_42348033/article/details/104892903</a></li>
<li>多项式插值之Lagrange、PCHIP与Spline以及BD-Rate和BD-PSNR的计算 <a href="https://blog.csdn.net/qq_33552519/article/details/102742715" target="_blank" rel="noopener">https://blog.csdn.net/qq_33552519/article/details/102742715</a></li>
<li>ROC及AUC计算方法及原理 <a href="https://blog.csdn.net/yinyu19950811/article/details/81288287" target="_blank" rel="noopener">https://blog.csdn.net/yinyu19950811/article/details/81288287</a></li>
</ul>

  </div>
</article>

<div id="paginator">
  
</div>

  </div>
</div>

<div id="bottom-outer">
  <div id="bottom-inner">
    <div id="footer-info">
      <div class="post-date-left">
        
          Mon Jul 05 2021 16:25:04 GMT+0800
        
      </div>
      <div class="site-title-area">
        <div class="site-title">
          <a href="/">Home</a>
        </div>
        <div class="site-subtitle">
          Site by Shangxin using
          <a href="http://hexo.io">hexo blog framework</a>
        </div>
      </div>
      <div class="post-date-right">
        
          Mon Jul 05 2021 16:25:04 GMT+0800
        
      </div>
    </div>
    
      

    <div class="vcomments" id="vcomments"></div>
    <script src="https://unpkg.com/valine/dist/Valine.min.js"></script>
    <script>
        new Valine({
            el: '#vcomments',
            appId: 'b47PMHdzebB0ozGGdW68aQAN-gzGzoHsz',
            appKey: 'pnCuygqUh5uDjQt8wNEKSd8K',
            notify: 'false',
            verify: 'false',
            avatar: 'mp',
            pageSize: '10',
            placeholder: '请输入...',
            visitor: 'true'
        })
    </script>

      
        <span id="/2021/07/05/编码器测评-BD-Rate/" class="leancloud-visitors view" data-flag-title>
          <em class="post-meta-item-text">阅读量 </em>
          <i class="leancloud-visitors-count">不知道 &gt;_&lt;</i>
        </span>
      
    
    <!-- 不蒜子网站访问量统计 -->
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span id="busuanzi_container_site_pv">本站总访问量<span id="busuanzi_value_site_pv"></span>次</span>
  </div>
</div>


  <!-- scripts list from theme config.yml -->
  
    <script src="/js/acanal.js"></script>
  


</body>
</html>
