<!DOCTYPE html>
<html lang="en">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  
  
  
    <meta name="description" content="Shangxin 的个人学习笔记。精力原因，也许只为自己方便翻阅。">
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <title>
    
    不懂鸟语的人</title>
  
    <link rel="shortcut icon" href="/favicon.ico">
  
  <link rel="stylesheet" href="/css/style.css">
  
    <link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">
  
  <script src="/js/pace.min.js"></script>
</head>
</html>
<body>
<main class="content">
  <section class="jumbotron">
  <div class="video">
    
      <div class="video-frame">
        <img src="/images/ocean/overlay-hero.png" alt="Decorative image frame">
      </div>
    
    <div class="video-media">
      <video playsinline="" autoplay="" loop="" muted="" data-autoplay=""
             poster="/images/ocean/ocean.png" x5-video-player-type="h5">
        <source src="/images/ocean/ocean.mp4" type="video/mp4">
        <source src="/images/ocean/ocean.ogv" type="video/ogg">
        <source src="/images/ocean/ocean.webm" type="video/webm">
        <p>Your user agent does not support the HTML5 Video element.</p>
      </video>
      <div class="video-overlay"></div>
    </div>
    <div class="video-inner text-center text-white">
      <h1><a href="/">不懂鸟语的人</a></h1>
      <p>我的个人学习笔记</p>
      <div><img src="/images/hexo-inverted.svg" class="brand" alt="不懂鸟语的人"></div>
    </div>
    <div class="video-learn-more">
      <a class="anchor" href="#landingpage"><i class="fe fe-mouse"></i></a>
    </div>
  </div>
</section>

<div id="landingpage">
  <section class="outer">
    <article class="articles">
      
      <h1 class="page-type-title"></h1>
      
        
          <article id="post-Git-Commit-规范约束探索" class="article article-type-post" itemscope itemprop="blogPost" data-scroll-reveal>

    <div class="article-inner">
        
            <header class="article-header">
                
  
    <h2 itemprop="name">
      <a class="article-title" href="/2019/11/20/Git-Commit-规范约束探索/">git commit 规范约束探索</a>
    </h2>
  
  




            </header>
            

                
                    <div class="article-meta">
                        <a href="/2019/11/20/Git-Commit-规范约束探索/" class="article-date">
  <time datetime="2019-11-19T16:32:11.000Z" itemprop="datePublished">2019-11-20</time>
</a>
                            
                    </div>
                    

                        

                                    <div class="article-entry" itemprop="articleBody">
                                        


                                            

                                                
                                                                    <h2 id="起因"><a href="#起因" class="headerlink" title="起因"></a>起因</h2><p>今天看到同事的 commit message 很随意，我觉得不能再这么下去了。<br>于是我和朋友讨论了一下这件事和解决方案，感觉靠自觉还不如靠自动化检查。</p>
<h2 id="找了些什么"><a href="#找了些什么" class="headerlink" title="找了些什么"></a>找了些什么</h2><p>于是我去网上找了一下这方面的工具，找到了以下的解决方案：</p>
<ul>
<li><p>commitizen</p>
</li>
<li><p>commitlint</p>
</li>
</ul>
<p>前者的方案是另起了一个 <code>git cz</code> 命令来进入commitizen 的使用流程，需要手动选择一个 commit type。</p>
<p>这样的操作略显繁琐，而且因为对原有 <code>git commit</code> 命令没有干扰，所以并不是很严格。而且在其他的 git GUI 工具中这个就不是很容易来利用这个了。</p>
<p>于是，我看了一下后者：commitlint，这个是利用了 husky 这个 git hook 工具，hook 了原有的 <code>git commit</code> 命令，对 commit 操作进行了拦截检查。</p>
<p>显然后者更符合我的需求。</p>
<h2 id="部署"><a href="#部署" class="headerlink" title="部署"></a>部署</h2><p>依赖于 node/npm 环境，这个需要事现安装好。</p>
<h3 id="安装依赖"><a href="#安装依赖" class="headerlink" title="安装依赖"></a>安装依赖</h3><p>运行以下命令进行安装：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save-dev @commitlint/cli @commitlint/config-conventional husky</span><br></pre></td></tr></table></figure>
<p>这行命令安装了三个包：</p>
<ul>
<li><p><code>@commitlint/cli</code>: commitlint 的 CLI 工具</p>
</li>
<li><p><code>@commitlint/config-conventional</code>: commitlint 的 conventional 规范配置方案，这是一个从 config-angular 衍生出的一个分支</p>
</li>
<li><p><code>husky</code>: 一款 git hook 工具，可以 hook git 的命令</p>
<p>补充：<br>​    <code>--save-dev</code> 参数表示将依赖写进 package.json 的 devDependencies 中，devDependencies 中的依赖只会在开发时安装，在部署时会被忽略。</p>
</li>
</ul>
<h3 id="Commitlint-配置"><a href="#Commitlint-配置" class="headerlink" title="Commitlint 配置"></a>Commitlint 配置</h3><p>项目根目录新建文件 commitlint.config.js 来存放 commitlint 的配置信息，写入以下内容：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  extends: [<span class="string">'@commitlint/config-conventional'</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>@commitlint/config-conventional</code> 是刚才安装的 commitlint 规范配置方案，可以安装并替换为其他的配置（例如 <code>config-angular</code>）。</p>
<h3 id="Husky-配置"><a href="#Husky-配置" class="headerlink" title="Husky 配置"></a>Husky 配置</h3><p>有两种配置方式</p>
<h4 id="方式一"><a href="#方式一" class="headerlink" title="方式一"></a>方式一</h4><p>在根目录的 package.json 加入以下配置信息：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"husky"</span>: &#123;</span><br><span class="line">    <span class="attr">"hooks"</span>: &#123;</span><br><span class="line">      <span class="attr">"commit-msg"</span>: <span class="string">"commitlint -E HUSKY_GIT_PARAMS"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="方式二"><a href="#方式二" class="headerlink" title="方式二"></a>方式二</h4><p>Husky 的版本 &gt;= 1.0.0</p>
<p>.huskyrc 或 .huskyrc.json 或者 .huskyrc.js 文件建在根目录，写入以下内容：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"hooks"</span>: &#123;</span><br><span class="line">    <span class="attr">"commit-msg"</span>: <span class="string">"commitlint -E HUSKY_GIT_PARAMS"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>另外看一下里面具体写了些什么：</p>
<p><code>commit-msg</code> 代表对 commit message 进行 hook，hook 的时候执行后面的命令 <code>commitlint -E HUSKY_GIT_PARAMS</code> 进行检查。</p>
<p>可以直接在命令行执行 <code>commitlint -h</code>  看一下 commitlint CLI 的具体用法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">@commitlint/cli@8.2.0 - Lint your commit messages</span><br><span class="line"></span><br><span class="line">[input] reads from stdin if --edit, --env, --from and --to are omitted</span><br><span class="line">--color, -c            toggle colored output, defaults to: true</span><br><span class="line">--config, -g           path to the config file</span><br><span class="line">--cwd, -d              directory to execute in, defaults to: D:\Projects\video_studio</span><br><span class="line">--edit, -e             read last commit message from the specified file or fallbacks to ./.git/COMMIT_EDITMSG</span><br><span class="line">--env, -E              check message in the file at path given by environment variable value</span><br><span class="line">--extends, -x          array of shareable configurations to extend</span><br><span class="line">--help, -h             display this help message</span><br><span class="line">--from, -f             lower end of the commit range to lint; applies if edit=false</span><br><span class="line">--format, -o           output format of the results</span><br><span class="line">--parser-preset, -p    configuration preset to use for conventional-commits-parser</span><br><span class="line">--quiet, -q            toggle console output</span><br><span class="line">--to, -t               upper end of the commit range to lint; applies if edit=false</span><br><span class="line">--version, -v          display version information</span><br><span class="line">--verbose, -V          enable verbose output for reports without problems</span><br></pre></td></tr></table></figure>
<p>这里用到的 <code>commitlint -E</code> 是 <code>commitlint --env</code> 的简写。</p>
<h2 id="测试一下"><a href="#测试一下" class="headerlink" title="测试一下"></a>测试一下</h2><p>到此，部署完毕，可以试一下效果。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git add commitlint.config.js</span><br><span class="line">git commit -m <span class="string">"test"</span></span><br></pre></td></tr></table></figure>
<p>可以看到检查和报错：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">husky &gt; commit-msg (node v8.16.0)</span><br><span class="line">⧗   input: <span class="built_in">test</span></span><br><span class="line">✖   subject may not be empty [subject-empty]</span><br><span class="line">✖   <span class="built_in">type</span> may not be empty [<span class="built_in">type</span>-empty]</span><br><span class="line"></span><br><span class="line">✖   found 2 problems, 0 warnings</span><br><span class="line">ⓘ   Get <span class="built_in">help</span>: https://github.com/conventional-changelog/commitlint/<span class="comment">#what-is-commitlint</span></span><br><span class="line"></span><br><span class="line">husky &gt; commit-msg hook failed (add --no-verify to bypass)</span><br></pre></td></tr></table></figure>
<p>完毕~</p>

                                                                        
                                    </div>
                                    <footer class="article-footer">
                                        <a data-url="http://yoursite.com/2019/11/20/Git-Commit-规范约束探索/" data-id="ck726kee30003hc74wiudfgv6" class="article-share-link">
                                            Share
                                        </a>
                                        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Git/">Git</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Node-js/">Node.js</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/工作/">工作</a></li></ul>

                                    </footer>

    </div>

    

                

</article>
        
          <article id="post-用-JS-把-Video-转为-Audio" class="article article-type-post" itemscope itemprop="blogPost" data-scroll-reveal>

    <div class="article-inner">
        
            <header class="article-header">
                
  
    <h2 itemprop="name">
      <a class="article-title" href="/2018/07/04/用-JS-把-Video-转为-Audio/">用 JS 把 Video 转为 Audio</a>
    </h2>
  
  




            </header>
            

                
                    <div class="article-meta">
                        <a href="/2018/07/04/用-JS-把-Video-转为-Audio/" class="article-date">
  <time datetime="2018-07-04T15:38:39.000Z" itemprop="datePublished">2018-07-04</time>
</a>
                            
                    </div>
                    

                        

                                    <div class="article-entry" itemprop="articleBody">
                                        


                                            

                                                
                                                                    <p>参考了一下 StackOverflow <a href="https://stackoverflow.com/questions/49140159/extracting-audio-from-a-video-file/49182456#49182456" target="_blank" rel="noopener">https://stackoverflow.com/questions/49140159/extracting-audio-from-a-video-file/49182456#49182456</a><br>以下代码可以提取出音频，但是音频体积却比源视频大的问题却没解决。<br>或许我该用 offlineAudioContext.startRendering() 这个方法试试？</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> videoSrc = <span class="string">'http://otof18y9e.bkt.clouddn.com/frag_bunny.mp4'</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">startSelect</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> audioContext = <span class="keyword">new</span> OfflineAudioContext(<span class="number">2</span>, <span class="number">44100</span> * <span class="number">100</span>, <span class="number">44100</span>);</span><br><span class="line">  <span class="comment">// var audioContext = new window.AudioContext()</span></span><br><span class="line">  <span class="keyword">var</span> videoFileAsBuffer = <span class="keyword">new</span> <span class="built_in">Promise</span>(requestVideo)</span><br><span class="line">  videoFileAsBuffer.then(<span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(data)</span><br><span class="line">    audioContext.decodeAudioData(data).then(<span class="function"><span class="keyword">function</span> (<span class="params">decodedAudioData</span>) </span>&#123;</span><br><span class="line">        mySoundBuffer = decodedAudioData</span><br><span class="line">        soundSource = audioContext.createBufferSource()</span><br><span class="line">        soundSource.buffer = mySoundBuffer</span><br><span class="line">        soundSource.connect(audioContext.destination)</span><br><span class="line">        <span class="comment">// soundSource.start()</span></span><br><span class="line">        <span class="built_in">console</span>.log(mySoundBuffer.length)</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">requestVideo</span>(<span class="params">resolve</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest()</span><br><span class="line">  xhr.open(<span class="string">'GET'</span>, videoSrc, <span class="literal">true</span>)</span><br><span class="line">  xhr.responseType = <span class="string">'arraybuffer'</span> <span class="comment">// 'blob'</span></span><br><span class="line"></span><br><span class="line">  xhr.onload = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> binaryData = <span class="keyword">this</span>.response</span><br><span class="line">      <span class="comment">// console.log(binaryData)</span></span><br><span class="line">      resolve(binaryData)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  xhr.send()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

                                                                        
                                    </div>
                                    <footer class="article-footer">
                                        <a data-url="http://yoursite.com/2018/07/04/用-JS-把-Video-转为-Audio/" data-id="ck726kef0000phc74u7c2w79x" class="article-share-link">
                                            Share
                                        </a>
                                        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Audio/">Audio</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Transcoding/">Transcoding</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Video/">Video</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li></ul>

                                    </footer>

    </div>

    

                

</article>
        
          <article id="post-JS-录制压缩16K采样率-SampleRate-音频" class="article article-type-post" itemscope itemprop="blogPost" data-scroll-reveal>

    <div class="article-inner">
        
            <header class="article-header">
                
  
    <h2 itemprop="name">
      <a class="article-title" href="/2018/06/29/JS-录制压缩16K采样率-SampleRate-音频/">JS 录制压缩16K采样率(SampleRate)音频</a>
    </h2>
  
  




            </header>
            

                
                    <div class="article-meta">
                        <a href="/2018/06/29/JS-录制压缩16K采样率-SampleRate-音频/" class="article-date">
  <time datetime="2018-06-29T06:20:49.000Z" itemprop="datePublished">2018-06-29</time>
</a>
                            
                    </div>
                    

                        

                                    <div class="article-entry" itemprop="articleBody">
                                        


                                            

                                                
                                                                    <h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>考研复习期间压力大，写点代码放松一下。另外，没接触过音频编码相关知识…</p>
<h2 id="开搞"><a href="#开搞" class="headerlink" title="开搞"></a>开搞</h2><h3 id="目的"><a href="#目的" class="headerlink" title="目的"></a>目的</h3><p>涉及到 JS 的语音识别，录音我使用的是 <a href="https://github.com/mattdiamond/Recorderjs" target="_blank" rel="noopener">Recorder.js</a>。各个平台只接受 16K/8K SampleRate 的音频，JS 录制默认是 44.1K SampleRate，这时需要压缩采样率。</p>
<h3 id="可选方案"><a href="#可选方案" class="headerlink" title="可选方案"></a>可选方案</h3><ol>
<li>ffmpeg.js（ffmpeg 的 JS 移植版），大略看一下，用起来貌似有点麻烦，库还很大，暂且放弃。</li>
<li>手动压。<h2 id="手动压"><a href="#手动压" class="headerlink" title="手动压"></a>手动压</h2>参考了 <a href="http://www.cnblogs.com/blqw/p/3782420.html" target="_blank" rel="noopener">http://www.cnblogs.com/blqw/p/3782420.html</a> ，可是目的不完全相同，于是我在它的基础上操刀。<br>主要针对两个函数入手：interleave、encodeWAV。<br>首先在上部分声明一个“newSampleRate”<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> newSampleRate = <span class="number">16000</span>;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="原版"><a href="#原版" class="headerlink" title="原版"></a>原版</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 原版</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">interleave</span>(<span class="params">inputL, inputR</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> length = inputL.length + inputR.length;</span><br><span class="line">    <span class="keyword">var</span> result = <span class="keyword">new</span> <span class="built_in">Float32Array</span>(length);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> index = <span class="number">0</span>,</span><br><span class="line">        inputIndex = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (index &lt; length) &#123;</span><br><span class="line">        result[index++] = inputL[inputIndex];</span><br><span class="line">        result[index++] = inputR[inputIndex];</span><br><span class="line">        inputIndex++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">encodeWAV</span>(<span class="params">samples</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> buffer = <span class="keyword">new</span> <span class="built_in">ArrayBuffer</span>(<span class="number">44</span> + samples.length * <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">var</span> view = <span class="keyword">new</span> <span class="built_in">DataView</span>(buffer);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* RIFF identifier */</span></span><br><span class="line">    writeString(view, <span class="number">0</span>, <span class="string">'RIFF'</span>);</span><br><span class="line">    <span class="comment">/* RIFF chunk length */</span></span><br><span class="line">    view.setUint32(<span class="number">4</span>, <span class="number">36</span> + samples.length * <span class="number">2</span>, <span class="literal">true</span>);</span><br><span class="line">    <span class="comment">/* RIFF type */</span></span><br><span class="line">    writeString(view, <span class="number">8</span>, <span class="string">'WAVE'</span>);</span><br><span class="line">    <span class="comment">/* format chunk identifier */</span></span><br><span class="line">    writeString(view, <span class="number">12</span>, <span class="string">'fmt '</span>);</span><br><span class="line">    <span class="comment">/* format chunk length */</span></span><br><span class="line">    view.setUint32(<span class="number">16</span>, <span class="number">16</span>, <span class="literal">true</span>);</span><br><span class="line">    <span class="comment">/* sample format (raw) */</span></span><br><span class="line">    view.setUint16(<span class="number">20</span>, <span class="number">1</span>, <span class="literal">true</span>);</span><br><span class="line">    <span class="comment">/* channel count */</span></span><br><span class="line">    view.setUint16(<span class="number">22</span>, numChannels, <span class="literal">true</span>);</span><br><span class="line">    <span class="comment">/* sample rate */</span></span><br><span class="line">    view.setUint32(<span class="number">24</span>, sampleRate, <span class="literal">true</span>);</span><br><span class="line">    <span class="comment">/* byte rate (sample rate * block align) */</span></span><br><span class="line">    view.setUint32(<span class="number">28</span>, sampleRate * <span class="number">4</span>, <span class="literal">true</span>);</span><br><span class="line">    <span class="comment">/* block align (channel count * bytes per sample) */</span></span><br><span class="line">    view.setUint16(<span class="number">32</span>, numChannels * <span class="number">2</span>, <span class="literal">true</span>);</span><br><span class="line">    <span class="comment">/* bits per sample */</span></span><br><span class="line">    view.setUint16(<span class="number">34</span>, <span class="number">16</span>, <span class="literal">true</span>);</span><br><span class="line">    <span class="comment">/* data chunk identifier */</span></span><br><span class="line">    writeString(view, <span class="number">36</span>, <span class="string">'data'</span>);</span><br><span class="line">    <span class="comment">/* data chunk length */</span></span><br><span class="line">    view.setUint32(<span class="number">40</span>, samples.length * <span class="number">2</span>, <span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">    floatTo16BitPCM(view, <span class="number">44</span>, samples);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> view;</span><br><span class="line">&#125;</span><br><span class="line">&#125;, self);</span><br></pre></td></tr></table></figure>
<h3 id="修改后单声道版（大部分语音识别都只支持单声道）"><a href="#修改后单声道版（大部分语音识别都只支持单声道）" class="headerlink" title="修改后单声道版（大部分语音识别都只支持单声道）"></a>修改后单声道版（大部分语音识别都只支持单声道）</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 修改后 单声道</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">interleave</span>(<span class="params">inputL</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> compression = <span class="number">44100</span> / newSampleRate;</span><br><span class="line">    <span class="keyword">var</span> length = inputL.length / compression;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'length:'</span> + length)</span><br><span class="line">    <span class="keyword">var</span> result = <span class="keyword">new</span> <span class="built_in">Float32Array</span>(length);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> index = <span class="number">0</span>,</span><br><span class="line">        inputIndex = <span class="number">0</span>; </span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (index &lt; length)&#123;</span><br><span class="line">        result[index++] = inputL[<span class="built_in">parseInt</span>(inputIndex)];</span><br><span class="line">        inputIndex += compression;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 修改后 单声道版</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">encodeWAV</span>(<span class="params">samples</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> buffer = <span class="keyword">new</span> <span class="built_in">ArrayBuffer</span>(<span class="number">44</span> + samples.length * <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">var</span> view = <span class="keyword">new</span> <span class="built_in">DataView</span>(buffer);</span><br><span class="line"></span><br><span class="line">    numChannels = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> bitPerSample = <span class="number">16</span> * <span class="number">2</span>,</span><br><span class="line">        blockAlign = numChannels * (bitPerSample / <span class="number">8</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* RIFF identifier */</span></span><br><span class="line">    writeString(view, <span class="number">0</span>, <span class="string">'RIFF'</span>);</span><br><span class="line">    <span class="comment">/* RIFF chunk length */</span></span><br><span class="line">    view.setUint32(<span class="number">4</span>, <span class="number">36</span> + samples.length * <span class="number">2</span>, <span class="literal">true</span>);</span><br><span class="line">    <span class="comment">/* RIFF type */</span></span><br><span class="line">    writeString(view, <span class="number">8</span>, <span class="string">'WAVE'</span>);</span><br><span class="line">    <span class="comment">/* format chunk identifier */</span></span><br><span class="line">    writeString(view, <span class="number">12</span>, <span class="string">'fmt '</span>);</span><br><span class="line">    <span class="comment">/* format chunk length */</span></span><br><span class="line">    view.setUint32(<span class="number">16</span>, <span class="number">16</span>, <span class="literal">true</span>);</span><br><span class="line">    <span class="comment">/* sample format (raw) */</span></span><br><span class="line">    view.setUint16(<span class="number">20</span>, <span class="number">1</span>, <span class="literal">true</span>);</span><br><span class="line">    <span class="comment">/* channel count */</span></span><br><span class="line">    view.setUint16(<span class="number">22</span>, numChannels, <span class="literal">true</span>);</span><br><span class="line">    <span class="comment">/* sample rate */</span></span><br><span class="line">    view.setUint32(<span class="number">24</span>, newSampleRate, <span class="literal">true</span>);</span><br><span class="line">    <span class="comment">/* byte rate (sample rate * block align) */</span></span><br><span class="line">    view.setUint32(<span class="number">28</span>, newSampleRate * blockAlign, <span class="literal">true</span>);</span><br><span class="line">    <span class="comment">/* block align (channel count * bytes per sample) */</span></span><br><span class="line">    view.setUint16(<span class="number">32</span>, blockAlign, <span class="literal">true</span>);</span><br><span class="line">    <span class="comment">/* bits per sample */</span></span><br><span class="line">    view.setUint16(<span class="number">34</span>, bitPerSample, <span class="literal">true</span>);</span><br><span class="line">    <span class="comment">/* data chunk identifier */</span></span><br><span class="line">    writeString(view, <span class="number">36</span>, <span class="string">'data'</span>);</span><br><span class="line">    <span class="comment">/* data chunk length */</span></span><br><span class="line">    view.setUint32(<span class="number">40</span>, samples.length * <span class="number">2</span>, <span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">    floatTo16BitPCM(view, <span class="number">44</span>, samples);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> view;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="修改后双声道版"><a href="#修改后双声道版" class="headerlink" title="修改后双声道版"></a>修改后双声道版</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 修改后 双声道版</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">interleave</span>(<span class="params">inputL, inputR</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> compression = <span class="number">44100</span> / newSampleRate; <span class="comment">// </span></span><br><span class="line">    <span class="keyword">var</span> length = (inputL.length + inputR.length) / compression;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'length:'</span> + length)</span><br><span class="line">    <span class="keyword">var</span> result = <span class="keyword">new</span> <span class="built_in">Float32Array</span>(length);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> index = <span class="number">0</span>,</span><br><span class="line">        inputIndex = <span class="number">0</span>; </span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (index &lt; length)&#123;</span><br><span class="line">        result[index++] = inputL[<span class="built_in">parseInt</span>(inputIndex)];</span><br><span class="line">        result[index++] = inputR[<span class="built_in">parseInt</span>(inputIndex)];</span><br><span class="line">        inputIndex += compression;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 修改后 双声道版</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">encodeWAV</span>(<span class="params">samples</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> buffer = <span class="keyword">new</span> <span class="built_in">ArrayBuffer</span>(<span class="number">44</span> + samples.length * <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">var</span> view = <span class="keyword">new</span> <span class="built_in">DataView</span>(buffer);</span><br><span class="line"></span><br><span class="line">    numChannels = <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> bitPerSample = <span class="number">16</span>,</span><br><span class="line">        blockAlign = numChannels * (bitPerSample / <span class="number">8</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* RIFF identifier */</span></span><br><span class="line">    writeString(view, <span class="number">0</span>, <span class="string">'RIFF'</span>);</span><br><span class="line">    <span class="comment">/* RIFF chunk length */</span></span><br><span class="line">    view.setUint32(<span class="number">4</span>, <span class="number">36</span> + samples.length * <span class="number">2</span>, <span class="literal">true</span>);</span><br><span class="line">    <span class="comment">/* RIFF type */</span></span><br><span class="line">    writeString(view, <span class="number">8</span>, <span class="string">'WAVE'</span>);</span><br><span class="line">    <span class="comment">/* format chunk identifier */</span></span><br><span class="line">    writeString(view, <span class="number">12</span>, <span class="string">'fmt '</span>);</span><br><span class="line">    <span class="comment">/* format chunk length */</span></span><br><span class="line">    view.setUint32(<span class="number">16</span>, <span class="number">16</span>, <span class="literal">true</span>);</span><br><span class="line">    <span class="comment">/* sample format (raw) */</span></span><br><span class="line">    view.setUint16(<span class="number">20</span>, <span class="number">1</span>, <span class="literal">true</span>);</span><br><span class="line">    <span class="comment">/* channel count */</span></span><br><span class="line">    view.setUint16(<span class="number">22</span>, numChannels, <span class="literal">true</span>);</span><br><span class="line">    <span class="comment">/* sample rate */</span></span><br><span class="line">    view.setUint32(<span class="number">24</span>, newSampleRate, <span class="literal">true</span>);</span><br><span class="line">    <span class="comment">/* byte rate (sample rate * block align) */</span></span><br><span class="line">    view.setUint32(<span class="number">28</span>, newSampleRate * blockAlign, <span class="literal">true</span>);</span><br><span class="line">    <span class="comment">/* block align (channel count * bytes per sample) */</span></span><br><span class="line">    view.setUint16(<span class="number">32</span>, blockAlign, <span class="literal">true</span>);</span><br><span class="line">    <span class="comment">/* bits per sample */</span></span><br><span class="line">    view.setUint16(<span class="number">34</span>, bitPerSample, <span class="literal">true</span>);</span><br><span class="line">    <span class="comment">/* data chunk identifier */</span></span><br><span class="line">    writeString(view, <span class="number">36</span>, <span class="string">'data'</span>);</span><br><span class="line">    <span class="comment">/* data chunk length */</span></span><br><span class="line">    view.setUint32(<span class="number">40</span>, samples.length * <span class="number">2</span>, <span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">    floatTo16BitPCM(view, <span class="number">44</span>, samples);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> view;</span><br><span class="line">&#125;</span><br><span class="line">&#125;, self);</span><br></pre></td></tr></table></figure>
<p><em>不过最后效果好像还有些缺陷…不保证能用…以后有时间再研究研究…</em></p>

                                                                        
                                    </div>
                                    <footer class="article-footer">
                                        <a data-url="http://yoursite.com/2018/06/29/JS-录制压缩16K采样率-SampleRate-音频/" data-id="ck726kee40004hc74vegnsuiu" class="article-share-link">
                                            Share
                                        </a>
                                        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/AudioBuffer/">AudioBuffer</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SampleRate/">SampleRate</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li></ul>

                                    </footer>

    </div>

    

                

</article>
        
          <article id="post-闲扯一下哔哩哔哩实习的日子" class="article article-type-post" itemscope itemprop="blogPost" data-scroll-reveal>

    <div class="article-inner">
        
            <header class="article-header">
                
  
    <h2 itemprop="name">
      <a class="article-title" href="/2018/01/21/闲扯一下哔哩哔哩实习的日子/">闲扯一下哔哩哔哩实习的日子</a>
    </h2>
  
  




            </header>
            

                
                    <div class="article-meta">
                        <a href="/2018/01/21/闲扯一下哔哩哔哩实习的日子/" class="article-date">
  <time datetime="2018-01-21T08:13:30.000Z" itemprop="datePublished">2018-01-21</time>
</a>
                            
                    </div>
                    

                        

                                    <div class="article-entry" itemprop="articleBody">
                                        


                                            

                                                
                                                                    <h2 id="入职前"><a href="#入职前" class="headerlink" title="入职前"></a>入职前</h2><p>定的2017年6月8日入职，我6月7日到达膜（口..口?）都。在住处放下行李后，想去公司附近踩踩点，以免第二天找不到路。<br>这时候已经八点多了，我试探性问了一下，我微信上那位电面我的大佬竟然还在公司（内心OS：啊竟然还在加班，那我以后是不是也要天天加班，唉无所谓啊加就加咯~不过后来证明部门并没有加班的传统。出了地铁站我骑上了ofo，看着地图竟然还骑错两次方向（哭…最后终于到了公司，和大佬见了个面，还请我吃了顿小面（一直怪不好意思的。告知了我明天的报道大体流程，中午12点让我和一起入职的小姐姐直接上来20楼，免去了同事下楼接的麻烦。</p>
<h2 id="入职"><a href="#入职" class="headerlink" title="入职"></a>入职</h2><p>第二天6月8日，上午的流程结束后，我和一起入职的S上了20楼。负责带我俩的L和Z满面笑容地为我们介绍工作和同事。我哪经历过这场面，认识同事的时候心里紧张得要死…_(:з」∠)_介绍完毕我们去了一起去了楼下的信州府聚了个餐（一般只在有新人来或者有人离职之类特殊事情时才回来这里小奢侈一把，平时都是去吃小面、菜饭、心连心、捞面等店面，还别说，这些地方还比我想象中便宜实惠的多。<br>至于吃饭习惯问题，我还真吃不惯这里的味道，和饭量…（第一天在信州府没吃饱 = = 他们饭量咋那么小…</p>
<h2 id="步入正轨"><a href="#步入正轨" class="headerlink" title="步入正轨"></a>步入正轨</h2><h3 id="蹒跚起步"><a href="#蹒跚起步" class="headerlink" title="蹒跚起步"></a>蹒跚起步</h3><p>接下来的一周时间，我们快速入门了 Vue.js ，紧接着接手了我们的第一个项目“XX编辑器”。我高估了自己的开发效率…立了 flag 却没赶上 deadline = = （以后绝不轻易立 flag 了…一共过了一个多月吧，这个项目才算是基本完成了，剩下的就是日后的对接工作。<br>后来做了几个小活，其中一次还搞崩了线上机器 = =，最后发现根本没必要做哪些操作（脸红 = =。</p>
<h3 id="最头疼的部分"><a href="#最头疼的部分" class="headerlink" title="最头疼的部分"></a>最头疼的部分</h3><p>之后接手了上传加速计划中的 JS 并发上传组件重构工作，本以为一周就可以完成的，接手之后才发现没那么简单，直到一个半月后离职才做好基本框架。最开始是打算用 FineUploader 的，用了一周时间熟悉了 OSS 和 FU 的文档，发现设计之初就不适合自己去对接第三方 OSS 服务，且修改起来十分困难，遂弃之改用 WebUploader。<br>用了大概一两周时间，踩了七牛的坑受挫，转而调 BOS 接口。魔改了 WebUploader 的一个小细节，在 WebUploader 上调通了 BOS 服务。这一成果证明 WebUploader 在一定程度上是符合我们的需求的。<br>J 决定为了减轻我的工作量，把这适配工作交给各 OSS 提供商（讨论组中看到 J 怼乙方真吓人又心疼 = =。之后各家帮我们调好了 Demo，WebUploader 团队也复出帮我们适配了 BOS，我开始和他们沟通做整合，期间还因为我的粗心被熊场的 L 大怼了（哭~玻璃心。又过了一阵子踩了不少鉴权坑，和 J 一起适配了 preXXX 的鉴权，终于是在我离职前最后一天给搞得差不多能用了。最后一天我花了好几个小时，把我之前的几个项目都好好整理了注释和文档，方便后人维护，也给自己留个念想吧…</p>
<h2 id="自己还是太菜…"><a href="#自己还是太菜…" class="headerlink" title="自己还是太菜…"></a>自己还是太菜…</h2><p>这最后一个项目基本是我一个人从零搞起的，也是我耗费心血最大的一个。累归累，但是也学到了不少东西。和其他公司对接业务的时候务必仔细认真，不然耽误自己的时间也耽误对方的时间（太丢人了捂脸…<br>自己的功夫不够扎实，导致我效率不高，周会老板问这周能不能灰度，我…我…… = =</p>
<h2 id="小插曲"><a href="#小插曲" class="headerlink" title="小插曲"></a>小插曲</h2><p>从七月初开始，我就对 Web P2P （主要基于 WebRTC）产生了很浓的兴趣。经过调查我发现腾讯视频已经在部分 PGC 视频中采用了 Web P2P 技术，据说爱奇艺也储备了相关技术，不过我还没发现已经上线的痕迹。在和老板讨论后，我决定尝试做个 Demo 出来。我的目光落在了 <a href="http:webtorrent.io/" target="_blank" rel="noopener">Webtorrent</a> 身上，利用闲暇时间调了好久，却始终没有达到我心目中的效果。期间我了解到 PearPlayer，发现这个商业项目比较完善，但是仅客户端开源，不太适合采用。直到离职我也没能证明 WebTorrent 这条路可行，也许后来公司内部自己造相关轮子了也说不定~<br>七月底参加了新人入职培训“夏日大作战”，期间诞生了我在公司留下最大的财富“红靠XX”表情包（大雾。被群发后我去其他楼层办点事情都会被搭讪：你是XXXX吗？ = =<br>刚来到那阵子，我还经历了我最惨的一个经历：下班后鬼使神差坐错了地铁方向六站，下来后想去对面坐反方向回去，谁成想又过了六七站才发现是再次坐错了线路…这时的我已经心凉凉了，这些日子第一次感觉那么难过，手机查到的路线都是我没坐过的路线，让没有安全感的我不敢去尝试，只能 QQ 微信上和别人倾诉一下，然后我去找工作人员询问原路返回的方式。一共折腾了一个多小时，我才回到公司附近。想起在这孤苦伶仃，我一个马上22岁的大男人差点哭出来…<br>合租遇到一个渣室友，本来以为喜欢用怪怪的语气开玩笑，后来发现他处处针对我，那语气是真的充满攻击性…<br>刚下高铁，就感受到了地铁站工作人员的恶意…</p>
<h2 id="小喜悦"><a href="#小喜悦" class="headerlink" title="小喜悦"></a>小喜悦</h2><p>不过在这里最高兴的时候就是下班时间。中午吃饭完看大佬们风暴开黑，晚上下班后，因为回去住处还没有公司里面舒服，我就呆在公司做做自己的东西，打打游戏，还有和大佬“吹逼”hhhhh其实就是和大佬聊聊天长长见识啦…对了，还有晚上8:30（这时间就比较坑）发晚餐，我刚开始一阵子自己出去简单吃点然后回家，后来就干脆晚走点领盒饭2333<br>一笔很宝贵的财富，就是在这里认识了好多的人，让我长了不少见识，女装大佬、游戏大佬、玄deep学learning大佬、日语大佬、固态硬盘大佬、转码大佬、搜索大佬、AI 部门大佬、拒了 Google Offer 的大佬、藤校大佬等等等哈哈哈…不过也正是见到了他们，让我感觉我比自己想象中还要渺小，坚定了我第二年考研深造的信心~<br>在膜都还有些网友，经常可以聊聊天。还有，我的发小和高中同桌也在上海，周末也算有人约哈哈哈~</p>
<h2 id="完结撒花"><a href="#完结撒花" class="headerlink" title="完结撒花"></a>完结撒花</h2><p>本以为三个月很长，直到最后的日子我才感觉到，这时间过得可真快啊，我甚至有点舍不得这座城市、这个公司、这群同事了。离职时抱着长条小电视，最后望一眼国航大厦，溜了溜了…<br>哔哩哔哩 (゜-゜)つロ 干杯~-bilibili</p>

                                                                        
                                    </div>
                                    <footer class="article-footer">
                                        <a data-url="http://yoursite.com/2018/01/21/闲扯一下哔哩哔哩实习的日子/" data-id="ck726kef3000rhc74a3yit8vc" class="article-share-link">
                                            Share
                                        </a>
                                        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/bilibili/">bilibili</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/实习/">实习</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/工作/">工作</a></li></ul>

                                    </footer>

    </div>

    

                

</article>
        
          <article id="post-曲折的求职（ShiXi）经历" class="article article-type-post" itemscope itemprop="blogPost" data-scroll-reveal>

    <div class="article-inner">
        
            <header class="article-header">
                
  
    <h2 itemprop="name">
      <a class="article-title" href="/2018/01/21/曲折的求职（ShiXi）经历/">曲折的求职（ShiXi）经历</a>
    </h2>
  
  




            </header>
            

                
                    <div class="article-meta">
                        <a href="/2018/01/21/曲折的求职（ShiXi）经历/" class="article-date">
  <time datetime="2018-01-21T08:10:54.000Z" itemprop="datePublished">2018-01-21</time>
</a>
                            
                    </div>
                    

                        

                                    <div class="article-entry" itemprop="articleBody">
                                        


                                            

                                                
                                                                    <p>2017年4月初，学校举行了一年一度的招聘会。受限于学校层次，来的企业质量也不咋样。我便完善了一下去年暑假写好的简历，自己找实习。<br>我开始翻阅 V2EX 招聘板块，和各大心仪互联网公司官网的招聘页面，上传发送了我的简历与求职信。时间过得很快，已经半个多月过去，简历发送了一大堆，却几乎没有得到回应。<br>眼看到五月了，我在拉钩、大街等网站也投了数几十份的简历，却依然没有找到一份实习。这时候我通过朋友，麻烦了一些 T、B 工作过的人帮我看看简历，结果我却被批得信心近乎全无。<br>我重新审视我的简历，花了一两天的时间找了一个更清晰的新模板，认真重构了简历。改完后想起亲戚有朋友在美团，让帮忙打听能否内推，结果被卡在了学历这一关。<br>这时候我在酷安网的求职信有了回应，因为酷安一个人会兼顾前后端，所以阿酷（酷安负责人）丢给我一个即将改版的网站设计图，让我做出来当作面试题，响应式设计兼顾 PC 和手机端体验。几天后我交付作品，阿酷却表示培养成本太高而不要暑期实习生。唉，当初在求职信把情况都写得很清楚，却做完了面试题才表示我的时间不合适，这让我心里多少有点难受…<br>后来我接到了来自 V2EX 的程序员客栈的电话面试，同样以不招单纯暑期实习生的理由拒掉了我。不过小红书拒掉我是因为技术达不到要求hhhh…<br>之后的几天，我过了拉钩网的几个初筛，接到了几个电面，大多数都和上面相同原因挂掉。<br>我基本已经心灰意冷，想着今年暑假继续在家躺尸算了……<br>这天晚上，我看到了B站在 V2EX 的招聘帖，试着给帖子中的邮箱发了份简历。因为之前在官网投过简历，也感觉自己有点高攀，所以我也没抱什么希望。<br>第二天睡完懒觉起来，看到帖子中又出现了一位大佬的邮箱，想着也就投着试试呗，就又发了一份。订了外卖，玩着电脑等着外卖。下午四五点还有拉钩网上约好的一个电面，有点迷茫。<br>过了二十分钟，手机铃声响了。心想着外卖怎么来的那么快，但是一看号码不对啊，哎接了再说吧。对方表明了是XXX公司的，刚才收到了我的求职信，所以现在如果方便的话，想来个简单的电话面试。我并没有听清对方说的是什么公司，出于礼貌原因，我小心翼翼地又问了一下对方公司。当对方说出“上海哔哩哔哩”的时候，我的心提到了嗓子眼。<br>对方确实是我刚发过去的邮箱主人，可是我才刚发了二十分钟啊…而且我还在等着外卖啊…这一通电面让我措手不及……<br>我尽量调整好状态，总共进行了十来分钟，自我感觉回答得比较差，加上比较紧张，所以我猜基本是没戏了。想起网上看的经验，我试探着在最后问了一句这次面试大概结果如何，对方回答：“应该差不多，等我回去再和同事商量商量吧。”听到这句话，我眼睛放光，感觉又看到了一丝希望的火种。<br>时间过了两三天，我一直守着手机等着回应。有点等不及了，发现电面来自一个私人手机号，我就试探着加了对方的微信，询问结果。对方接受好友申请，诧异地问道：你已经通过了，HR还没给回电话吗？我：…？<br>半个多月过去，期间我又询问了几次，对方也催了HR几次。直到端午节后，HR才给我回了电话。简单一轮HR电面后，表示近期会给我发送入职邀请。<br>大约到了6.3日，我终于收到了Offer，上面的时间还把2017写成了2016（雾…<br>我收到HR修正后的Offer后，剪去我还算长的头发，正式离校了…<br>对…就是这些了……</p>

                                                                        
                                    </div>
                                    <footer class="article-footer">
                                        <a data-url="http://yoursite.com/2018/01/21/曲折的求职（ShiXi）经历/" data-id="ck726keey000nhc74s3lpeuhf" class="article-share-link">
                                            Share
                                        </a>
                                        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/实习/">实习</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/工作/">工作</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/求职/">求职</a></li></ul>

                                    </footer>

    </div>

    

                

</article>
        
          <article id="post-TensorFlow-学习笔记" class="article article-type-post" itemscope itemprop="blogPost" data-scroll-reveal>

    <div class="article-inner">
        
            <header class="article-header">
                
  
    <h2 itemprop="name">
      <a class="article-title" href="/2017/11/20/TensorFlow-学习笔记/">TensorFlow 学习笔记</a>
    </h2>
  
  




            </header>
            

                
                    <div class="article-meta">
                        <a href="/2017/11/20/TensorFlow-学习笔记/" class="article-date">
  <time datetime="2017-11-19T16:17:16.000Z" itemprop="datePublished">2017-11-20</time>
</a>
                            
                    </div>
                    

                        

                                    <div class="article-entry" itemprop="articleBody">
                                        


                                            

                                                
                                                                    <h1 id="TensorFlow-学习笔记"><a href="#TensorFlow-学习笔记" class="headerlink" title="TensorFlow 学习笔记"></a>TensorFlow 学习笔记</h1><p>@(深度学习)</p>
<p>纯粹的学习笔记，写给自己看的，防止遗忘。</p>
<h2 id="定义公式"><a href="#定义公式" class="headerlink" title="定义公式"></a>定义公式</h2><p>定义的公式只是 Computation Graph，在这执行这代码时计算还没发生，需要调用 run 方法并 feed 数据才真正执行。</p>
<h2 id="流程"><a href="#流程" class="headerlink" title="流程"></a>流程</h2><ol>
<li>定义算法公式，也就是神经网络 forward 时的计算。</li>
<li>定义 loss ，选定优化器，并指定优化器优化 loss。</li>
<li>迭代地对数据进行训练。</li>
<li>在测试集或验证集上对准确率进行评测。</li>
</ol>
<p>lambda</p>
<p>dense</p>
<h2 id="tf-nn-relu"><a href="#tf-nn-relu" class="headerlink" title="tf.nn.relu"></a>tf.nn.relu</h2><h2 id="tf-nn-tanh"><a href="#tf-nn-tanh" class="headerlink" title="tf.nn.tanh"></a>tf.nn.tanh</h2><h2 id="tf-nn-moment"><a href="#tf-nn-moment" class="headerlink" title="tf.nn.moment"></a>tf.nn.moment</h2><h2 id="tf-nn-softmax-cross-entropy-with-logits"><a href="#tf-nn-softmax-cross-entropy-with-logits" class="headerlink" title="tf.nn.softmax_cross_entropy_with_logits()"></a>tf.nn.softmax_cross_entropy_with_logits()</h2><p>tf.reduce_mean(tf.nn.softmax_cross_entropy_with_logits(logits, labels))<br>    =&gt;<br>tf.reduce_mean(tf.nn.softmax_cross_entropy_with_logits(logits = logits, labels = labels))</p>
<h2 id="tf-stack"><a href="#tf-stack" class="headerlink" title="tf.stack()"></a>tf.stack()</h2><p>tf.pack() =&gt; tf.stack()<br>tf.unpack() =&gt; tf.unstack()</p>
<h2 id="tf-nn-dropout"><a href="#tf-nn-dropout" class="headerlink" title="tf.nn.dropout()"></a>tf.nn.dropout()</h2><h2 id="tf-truncated-normal"><a href="#tf-truncated-normal" class="headerlink" title="tf.truncated_normal()"></a>tf.truncated_normal()</h2><h2 id="tf-reshape"><a href="#tf-reshape" class="headerlink" title="tf.reshape()"></a>tf.reshape()</h2><p>重新变换形状</p>
<h2 id="tf-reduce-mean"><a href="#tf-reduce-mean" class="headerlink" title="tf.reduce_mean()"></a>tf.reduce_mean()</h2><p>在某一维度上求平均值</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">reduce_mean(</span><br><span class="line">    input_tensor,</span><br><span class="line">    axis=None,</span><br><span class="line">    keepdims=None,</span><br><span class="line">    name=None,</span><br><span class="line">    reduction_indices=None,</span><br><span class="line">    keep_dims=None</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h1 id="Others"><a href="#Others" class="headerlink" title="Others"></a>Others</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a = tf.Variable()</span><br></pre></td></tr></table></figure>
<h2 id="tf-name-scope"><a href="#tf-name-scope" class="headerlink" title="tf.name_scope()"></a>tf.name_scope()</h2><p>对 tf.get_variable() 无效</p>
<h3 id="scope-reuse-variables"><a href="#scope-reuse-variables" class="headerlink" title="scope.reuse_variables()"></a>scope.reuse_variables()</h3><p>后面加    tf.get_variable() 可以重复用</p>
<h2 id="tf-equal"><a href="#tf-equal" class="headerlink" title="tf.equal()"></a>tf.equal()</h2><p>判断两个是否相等</p>
<h2 id="tf-cast"><a href="#tf-cast" class="headerlink" title="tf.cast()"></a>tf.cast()</h2><p>映射，参数一映射为参数二的类型</p>
<h2 id="tf-placeholder"><a href="#tf-placeholder" class="headerlink" title="tf.placeholder()"></a>tf.placeholder()</h2><p>占位符<br>input = tf.placeholder(tf.float32)<br>操作 = 函数(input)<br>sess.run(操作, feed_dict = {input: 2})</p>
<p>tf.placeholder(tf.float32, [None, 784])<br>第二个参数代表 tensor 的 shape， 也就是数据的尺寸。<br>None 代表不限条数的输入，784 代表每条输入是一个784 维的向量。</p>
<h2 id="tf-argmax"><a href="#tf-argmax" class="headerlink" title="tf.argmax"></a>tf.argmax</h2><p>返回最大值的索引</p>
<h2 id="tf-train"><a href="#tf-train" class="headerlink" title="tf.train"></a>tf.train</h2><h3 id="tf-train-Saver"><a href="#tf-train-Saver" class="headerlink" title="tf.train.Saver()"></a>tf.train.Saver()</h3><p>保存(save) 恢复(restore) 模型<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># save</span><br><span class="line">saver.save(sess, &apos;my-model&apos;, global_step = 0)</span><br><span class="line"># restore</span><br><span class="line">saver.restore(sess, &apos;my-model&apos;)</span><br></pre></td></tr></table></figure></p>
<h2 id="tf-nn-rnn-cell"><a href="#tf-nn-rnn-cell" class="headerlink" title="tf.nn.rnn_cell"></a>tf.nn.rnn_cell</h2><p>tf.nn.rnn_cell =&gt; tf.contrib.rnn</p>
<h3 id="tf-train-GradientDescentOptimizer"><a href="#tf-train-GradientDescentOptimizer" class="headerlink" title="tf.train.GradientDescentOptimizer()"></a>tf.train.GradientDescentOptimizer()</h3><p>梯度下降优化器</p>
<h2 id="tf-summary-FileWriter"><a href="#tf-summary-FileWriter" class="headerlink" title="tf.summary.FileWriter"></a>tf.summary.FileWriter</h2><p>tf.trian.SummaryWriter =&gt; tf.summary.FileWriter<br>Writes Summary protocol buffers to event files.</p>
<h2 id="tf-global-variables-initializer"><a href="#tf-global-variables-initializer" class="headerlink" title="tf.global_variables_initializer()"></a>tf.global_variables_initializer()</h2><p>tf.initialize_all_variables() =&gt; tf.global_variables_initializer()</p>
<h2 id="tf-matmul"><a href="#tf-matmul" class="headerlink" title="tf.matmul()"></a>tf.matmul()</h2><p>两个矩阵相乘</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">matmul(</span><br><span class="line">    a,</span><br><span class="line">    b,</span><br><span class="line">    transpose_a=False,</span><br><span class="line">    transpose_b=False,</span><br><span class="line">    adjoint_a=False,</span><br><span class="line">    adjoint_b=False,</span><br><span class="line">    a_is_sparse=False,</span><br><span class="line">    b_is_sparse=False,</span><br><span class="line">    name=None</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h2 id="tf-square"><a href="#tf-square" class="headerlink" title="tf.square()"></a>tf.square()</h2><p>平方</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">square(</span><br><span class="line">    x,</span><br><span class="line">    name=<span class="keyword">None</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>
                                                                        
                                    </div>
                                    <footer class="article-footer">
                                        <a data-url="http://yoursite.com/2017/11/20/TensorFlow-学习笔记/" data-id="ck726kee90008hc74hsnrn8ti" class="article-share-link">
                                            Share
                                        </a>
                                        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/TensorFlow/">TensorFlow</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/深度学习/">深度学习</a></li></ul>

                                    </footer>

    </div>

    

                

</article>
        
          <article id="post-Laravel-安装笔记" class="article article-type-post" itemscope itemprop="blogPost" data-scroll-reveal>

    <div class="article-inner">
        
            <header class="article-header">
                
  
    <h2 itemprop="name">
      <a class="article-title" href="/2017/10/12/Laravel-安装笔记/">Laravel 安装笔记</a>
    </h2>
  
  




            </header>
            

                
                    <div class="article-meta">
                        <a href="/2017/10/12/Laravel-安装笔记/" class="article-date">
  <time datetime="2017-10-11T17:18:19.000Z" itemprop="datePublished">2017-10-12</time>
</a>
                            
                    </div>
                    

                        

                                    <div class="article-entry" itemprop="articleBody">
                                        


                                            

                                                
                                                                    <p>环境变量<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export PATH=&quot;$PATH:$HOME/.config/composer/vendor/bin&quot;</span><br></pre></td></tr></table></figure></p>
<p>报错<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/root/.config/composer/vendor/bin/laravel: 17: /root/.config/composer/vendor/bin/laravel: /root/.config/composer/vendor/laravel/installer/laravel: Permission denied</span><br></pre></td></tr></table></figure></p>
<p>解决方案<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod 777 /root/.config/composer/vendor/laravel/installer/laravel</span><br></pre></td></tr></table></figure></p>
<pre><code>[Symfony\Component\Process\Exception\RuntimeException]                       
The Process class relies on proc_open, which is not available on your PHP i  
nstallation.
</code></pre><p>这是因为proc_open函数有风险，默认被禁用了。<br>解决方案<br>vim /usr/local/php/etc/php.ini<br>搜索disable_functions<br>删除proc_open</p>

                                                                        
                                    </div>
                                    <footer class="article-footer">
                                        <a data-url="http://yoursite.com/2017/10/12/Laravel-安装笔记/" data-id="ck726kee70006hc7463pxd4u6" class="article-share-link">
                                            Share
                                        </a>
                                        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Laravel/">Laravel</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/PHP/">PHP</a></li></ul>

                                    </footer>

    </div>

    

                

</article>
        
          <article id="post-fragment-mp4-转换" class="article article-type-post" itemscope itemprop="blogPost" data-scroll-reveal>

    <div class="article-inner">
        
            <header class="article-header">
                
  
    <h2 itemprop="name">
      <a class="article-title" href="/2017/08/11/fragment-mp4-转换/">fragment mp4 转换</a>
    </h2>
  
  




            </header>
            

                
                    <div class="article-meta">
                        <a href="/2017/08/11/fragment-mp4-转换/" class="article-date">
  <time datetime="2017-08-11T12:19:49.000Z" itemprop="datePublished">2017-08-11</time>
</a>
                            
                    </div>
                    

                        

                                    <div class="article-entry" itemprop="articleBody">
                                        


                                            

                                                
                                                                    <p>一个在线检测 mp4 文件是否已经 fragmented 的工具 <a href="http://nickdesaulniers.github.io/mp4info/" target="_blank" rel="noopener">http://nickdesaulniers.github.io/mp4info/</a></p>
<p>把一个 non-fragment MP4 转换成 fragment MP4，可以使用 FFmpeg 的 -movflags 来转换。</p>
<p>对于原始文件为非 MP4 文件</p>
<pre><code>ffmpeg -i trailer_1080p.mov -c:v copy -c:a copy -movflags frag_keyframe+empty_moov bunny_fragmented.mp4
</code></pre><p>对于原始文件已经是 MP4 文件</p>
<pre><code>ffmpeg -i non_fragmented.mp4 -movflags frag_keyframe+empty_moov fragmented.mp4
修正：
    ffmpeg -i non_fragmented.mp4 -strict -2 -movflags frag_keyframe+empty_moov fragmented.mp4
</code></pre><p>要强制输出文件的帧速率为24 fps（会丢失fragment）：<br>    ffmpeg -i input.avi -r 24 output.avi</p>
<p>参考资料：<br>    <a href="https://zhuanlan.zhihu.com/p/27248188" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/27248188</a><br>    <a href="https://stackoverflow.com/questions/32931685/the-encoder-aac-is-experimental-but-experimental-codecs-are-not-enabled" target="_blank" rel="noopener">https://stackoverflow.com/questions/32931685/the-encoder-aac-is-experimental-but-experimental-codecs-are-not-enabled</a><br>    <a href="http://ffmpeg.org/ffmpeg.html" target="_blank" rel="noopener">http://ffmpeg.org/ffmpeg.html</a></p>
<p>示例视频：<br>    <a href="http://nickdesaulniers.github.io/netfix/demo/frag_bunny.mp4" target="_blank" rel="noopener">http://nickdesaulniers.github.io/netfix/demo/frag_bunny.mp4</a></p>

                                                                        
                                    </div>
                                    <footer class="article-footer">
                                        <a data-url="http://yoursite.com/2017/08/11/fragment-mp4-转换/" data-id="ck726keet000jhc74jpn9iawv" class="article-share-link">
                                            Share
                                        </a>
                                        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ffmpeg/">ffmpeg</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/fmp4/">fmp4</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/fragment-mp4/">fragment mp4</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mp4/">mp4</a></li></ul>

                                    </footer>

    </div>

    

                

</article>
        
          <article id="post-Ubuntu-下安装-Node-js-最新版" class="article article-type-post" itemscope itemprop="blogPost" data-scroll-reveal>

    <div class="article-inner">
        
            <header class="article-header">
                
  
    <h2 itemprop="name">
      <a class="article-title" href="/2017/07/24/Ubuntu-下安装-Node-js-最新版/">Ubuntu 下安装 Node.js 最新版</a>
    </h2>
  
  




            </header>
            

                
                    <div class="article-meta">
                        <a href="/2017/07/24/Ubuntu-下安装-Node-js-最新版/" class="article-date">
  <time datetime="2017-07-24T08:19:48.000Z" itemprop="datePublished">2017-07-24</time>
</a>
                            
                    </div>
                    

                        

                                    <div class="article-entry" itemprop="articleBody">
                                        


                                            

                                                
                                                                    <p>直接用以下代码的话，经常会安装到一个很老的版本：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt install nodejs</span><br></pre></td></tr></table></figure>
<p>那么如果你想装最新版本，或者指定某版本，执行以下代码即可：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl -sL https:<span class="comment">//deb.nodesource.com/setup_6.x | bash - </span></span><br><span class="line">apt-get install nodejs -y</span><br></pre></td></tr></table></figure>
<p><em>其中 setup_6.x 的“6”修改为指定版本</em></p>

                                                                        
                                    </div>
                                    <footer class="article-footer">
                                        <a data-url="http://yoursite.com/2017/07/24/Ubuntu-下安装-Node-js-最新版/" data-id="ck726keeb0009hc74kf720u6l" class="article-share-link">
                                            Share
                                        </a>
                                        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Node-js/">Node.js</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Ubuntu/">Ubuntu</a></li></ul>

                                    </footer>

    </div>

    

                

</article>
        
          <article id="post-ES6-箭头函数解决-this-作用域问题" class="article article-type-post" itemscope itemprop="blogPost" data-scroll-reveal>

    <div class="article-inner">
        
            <header class="article-header">
                
  
    <h2 itemprop="name">
      <a class="article-title" href="/2017/07/21/ES6-箭头函数解决-this-作用域问题/">ES6 箭头函数解决 this 作用域问题</a>
    </h2>
  
  




            </header>
            

                
                    <div class="article-meta">
                        <a href="/2017/07/21/ES6-箭头函数解决-this-作用域问题/" class="article-date">
  <time datetime="2017-07-21T08:37:30.000Z" itemprop="datePublished">2017-07-21</time>
</a>
                            
                    </div>
                    

                        

                                    <div class="article-entry" itemprop="articleBody">
                                        


                                            

                                                
                                                                    <p>在写 JS 时，尤其是在写回调函数的时候，经常会遇到一个很头疼的问题：this 的指向并非我所想要的（我想使用 this 调用外面大的函数，可实际上往往调用的是当前小的函数）。<br>直到我发现了 ES6 的箭头函数可以完美的避免这个问题。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">() =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.infoHash) <span class="comment">// 此处 this 非当前箭头函数</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>对比<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.infoHash) <span class="comment">// 此处 this 为当前匿名函数</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>

                                                                        
                                    </div>
                                    <footer class="article-footer">
                                        <a data-url="http://yoursite.com/2017/07/21/ES6-箭头函数解决-this-作用域问题/" data-id="ck726kedx0001hc74or0rdgnq" class="article-share-link">
                                            Share
                                        </a>
                                        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ES6/">ES6</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li></ul>

                                    </footer>

    </div>

    

                

</article>
        
    </article>
    
  
    
      <nav class="page-nav">
        <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/">Next</a>
      </nav>
    
  </section>
</div>

  <footer class="footer">
  <div class="outer">
    <div class="float-right">
      <ul class="list-inline">
  
    <li><i class="fe fe-bar-chart"></i> <span id="busuanzi_value_site_pv"></span></li>
  
    <li><i class="fe fe-smile-alt"></i> <span id="busuanzi_value_site_uv"></span></li>
  
</ul>
    </div>
    <ul class="list-inline">
      <li>&copy; 2020 不懂鸟语的人</li>
      <li>Powered by <a href="http://hexo.io/" target="_blank">Hexo</a></li>
      <li>Theme  <a href="https://github.com/zhwangart/hexo-theme-ocean">Ocean</a></li>
    </ul>
  </div>
</footer>

</main>
<aside class="sidebar">
  <button class="navbar-toggle"></button>
<nav class="navbar">
  
    <div class="logo">
      <a href="/"><img src="/images/hexo.svg" alt="不懂鸟语的人"></a>
    </div>
  
  <ul class="nav nav-main">
    
      <li class="nav-item">
        <a class="nav-item-link" href="/">首页</a>
      </li>
    
      <li class="nav-item">
        <a class="nav-item-link" href="/archives">归档</a>
      </li>
    
      <li class="nav-item">
        <a class="nav-item-link" href="/gallery">相册</a>
      </li>
    
      <li class="nav-item">
        <a class="nav-item-link" href="/about">关于</a>
      </li>
    
      <li class="nav-item">
        <a class="nav-item-link" href="/links">友链</a>
      </li>
    
    <li class="nav-item">
      <a class="nav-item-link nav-item-search" title="Search">
        <i class="fe fe-search"></i>
        Search
      </a>
    </li>
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      <div class="totop" id="totop">
  <i class="fe fe-rocket"></i>
</div>
    </li>
    <li class="nav-item">
      
        <a class="nav-item-link" target="_blank" href="/atom.xml" title="RSS Feed">
          <i class="fe fe-feed"></i>
        </a>
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
</aside>
<script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.justifiedGallery.min.js"></script>
<script src="/js/lazyload.min.js"></script>
<script src="/js/busuanzi-2.3.pure.min.js"></script>

  <script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/ocean.js"></script>

</body>
</html>